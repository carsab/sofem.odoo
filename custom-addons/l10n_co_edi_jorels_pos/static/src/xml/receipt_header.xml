<?xml version="1.0" encoding="utf-8"?>
<!--Jorels S.A.S. - Copyright (2019-2024)-->
<!--This file is part of l10n_co_edi_jorels_pos.-->
<!--l10n_co_edi_jorels_pos is free software: you can redistribute it and/or modify-->
<!--it under the terms of the GNU Lesser General Public License as published by-->
<!--the Free Software Foundation, either version 3 of the License, or-->
<!--(at your option) any later version.-->
<!--l10n_co_edi_jorels_pos is distributed in the hope that it will be useful,-->
<!--but WITHOUT ANY WARRANTY; without even the implied warranty of-->
<!--MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the-->
<!--GNU Lesser General Public License for more details.-->
<!--You should have received a copy of the GNU Lesser General Public License-->
<!--along with l10n_co_edi_jorels_pos.  If not, see <https://www.gnu.org/licenses/>.-->
<!--email: info@jorels.com-->
<templates id="template" xml:space="preserve">
    <t t-inherit="point_of_sale.ReceiptHeader" t-inherit-mode="extension" t-name="l10n_co_edi_jorels_pos.ReceiptHeader">
        <xpath expr="//div[hasclass('pos-receipt-contact')]" position="after">
            <t t-set="partner" t-value="props.data.partner"/>
            <t t-if="partner and props.data.company?.country?.code == 'CO'">
                <div class="pos-receipt-left-align" style="font-size: 10px; line-height: 1.2; margin-bottom: 3px;">
                    <div t-if="partner.name">Nombre: 
                        <t t-esc="partner.name"/>
                    </div>
                    <div t-if="partner.vat">Documento: 
                        <t t-esc="partner.vat"/>
                    </div>
                    <div t-if="partner.mobile or partner.phone">Teléfono: 
                        <t t-esc="partner.mobile or partner.phone"/>
                    </div>
                    <br/>
                </div>
            </t>

            <t t-set="invoice" t-value="props.data.invoice"/>
            
            <div t-if="invoice and props.data.company?.country?.code == 'CO'" style="font-size: 10px; line-height: 1.2; margin-top: 5px;">

                <div style="margin-bottom: 10px;">
                    <div t-if="invoice.ei_is_valid">
                        <div style="font-size: 12px; line-height: 1.3;  font-weight: bold;">
                            <span>Factura electrónica de venta: </span>
                            <t t-esc="invoice.number"/>
                        </div>

                        <div style="word-wrap: break-word; font-size: 9px; line-height: 1.1; margin-bottom: 3px;">
                            <t t-esc="'CUFE:' + invoice.ei_uuid"/>
                        </div>

                        <div>
                            <span>Resolución DIAN No: </span>
                            <t t-esc="invoice.resolution_resolution"/>
                            <span> De: </span>
                            <t t-esc="invoice.resolution_resolution_date"/>
                        </div>
                        <div>  
                            <span>Numeración desde: </span>
                            <t t-esc="invoice.resolution_prefix"/>
                            <t t-esc="invoice.resolution_from"/>
                            <span> Hasta: </span>                    
                            <t t-esc="invoice.resolution_prefix"/>
                            <t t-esc="invoice.resolution_to"/>
                        </div>
                        <div>
                            <span>Vigente desde: </span>
                            <t t-esc="invoice.resolution_date_from"/>
                            <span> Hasta: </span>
                            <t t-esc="invoice.resolution_date_to"/>
                        </div>
                    </div>

                    <div t-else="">
                        <div style="font-size: 12px; line-height: 1.3;  font-weight: bold;">
                            <span>Factura electrónica de venta: </span>
                            <t t-esc="invoice.number"/>
                        </div>
                        
                        <div t-if="invoice.resolution_resolution">
                            <span>Resolución DIAN No: </span>
                            <t t-esc="invoice.resolution_resolution"/>
                            <span> De: </span>
                            <t t-esc="invoice.resolution_resolution_date"/>
                        </div>
                        <div t-if="invoice.resolution_prefix and invoice.resolution_from">  
                            <span>Numeración desde: </span>
                            <t t-esc="invoice.resolution_prefix"/>
                            <t t-esc="invoice.resolution_from"/>
                            <span> Hasta: </span>                    
                            <t t-esc="invoice.resolution_prefix"/>
                            <t t-esc="invoice.resolution_to"/>
                        </div>
                        <div t-if="invoice.resolution_date_from">
                            <span>Vigente desde: </span>
                            <t t-esc="invoice.resolution_date_from"/>
                            <span> Hasta: </span>
                            <t t-esc="invoice.resolution_date_to"/>
                        </div>                                  
                    </div>
                </div>

                <div class="hidden" id="ei_qr_data" t-esc="invoice.ei_qr_data"/>

                <div style="width: 100%; text-align: center; margin: 15px 0 10px 0; clear: both;">
                   <div id="qr_data" align="center" style="width: 190px; height: 190px; margin: 0 auto; display: block;"/>
                </div>

                <script class="pos-receipt-qrcode" type="text/javascript" style="display: none !important;">
                    setTimeout(function () {
                        var data = document.getElementById('ei_qr_data')?.innerText;
                        var container = document.getElementById('qr_data');
                        if (container) container.innerHTML = "";

                        if (data &amp;&amp; data !== "false") {
                            new QRCode(container, {
                                text: String(data),
                                width: 190,
                                height: 190,
                                colorDark: "#000000",
                                colorLight: "#ffffff",
                                correctLevel: QRCode.CorrectLevel.M
                            });
                        }
                    }, 0);
                </script>   

            </div>
        </xpath>
    </t>
</templates>